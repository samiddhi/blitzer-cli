#+TITLE: Blitzer CLI
#+SUBTITLE: A minimalist command-line tool for language text processing
#+AUTHOR: Blitzer Team
#+OPTIONS: toc:nil num:nil

* Overview

Blitzer CLI is a minimalist command-line tool for language text processing that produces a word frequency list from input text. In addition to simple word frequency list, it also can support lemmatization for different languages. In simple terms, lemmatization means that, taking English as an example, the output can optionally treat "running" "ran" and "runs" as three instances of the same word as opposed to three different words.

Optionally (but recommended) users can create and include their own word exclusion lists which will exclude words from the result. This essentially means that as vocabulary is acquired to you and added to this list, the output from this tool will be exclusively words you do not already know. The upfront cost of making and maintaining this exclusion list comes with the benefit of instant custom vocabulary for texts you intent to read, listen to, or study, as well as a way to track how many words you know in your language. Pretty cool!

The tool was designed for language learners and supports downloadable language packs via plugin architecture. Built-in language support includes Slovenian and Pāli (which are oddly specific, but my CLI, my rules!) with new languages installable as separate packages using =blitzer languages install <lang-code>=. Contributions for new languages are warmly accepted, and should be fairly straightforward to implement.

* Installation

** Using pip (recommended)
#+BEGIN_SRC sh
pip install -e .
#+END_SRC

** Prerequisites
- Python 3.7+
- =click= library
- =tomli= library (for Python < 3.11)

* Usage

** Basic Usage
The tool reads text from stdin and outputs processed word lists to stdout using a subcommand architecture with flags:

#+BEGIN_SRC sh
# With stdin
echo "Your text here" | blitzer blitz -l [language_code] [flags]

# With direct text input
blitzer blitz -t "Your text here" -l [language_code] [flags]
#+END_SRC

** Available Languages
- =generic= :: Generic processor for space-separated languages (no lemmatization support)
- =pli= :: Pali (with support for diacritics like ā, ī, ū, ṛ, ḷ, ṅ, ṇ, ñ, ṭ, ḍ, ś, ṣ, ṃ, ṁ)
- =slv= :: Slovenian (with support for č, š, ž)

** Available Commands
- =blitz= :: Main command for processing text with configurable flags
- =list= :: Lists supported languages for lemmatization
- =languages= :: Manage language packs (install, uninstall, list)

** Flags
- =-L=, =--lemmatize= :: Treats different declensions/forms of the same word as one word
- =-f=, =--freq= :: Include frequency counts in the output
- =-c=, =--context= :: Include sample context for each word in output
- =-p=, =--prompt= :: Include custom prompt for LLM at the top of output
- =-s=, =--src= :: Include the full source text at the top of output
- =-l=, =--language_code= :: ISO 639 three-character language code
- =-t=, =--text= :: Direct text input (overrides stdin)
- =-h=, =--help= :: Show help message

** Examples
#+BEGIN_SRC sh
# Basic word list
echo "This is a test." | blitzer blitz -l pli

# With frequency counts
echo "This is a test. This is only a test." | blitzer blitz -l pli -f

# With context sentences
echo "This is a test." | blitzer blitz -l pli -f -c

# Lemmatized output
echo "To je test." | blitzer blitz -l slv -L

# Using multiple flags
echo "This is a test." | blitzer blitz -l pli -L -f -c -p

# List available languages (built-in and plugins)
blitzer list

# Manage language packs
blitzer languages list
blitzer languages install [lang-code]
blitzer languages uninstall [lang-code]
#+END_SRC

* Configuration

The tool uses XDG specifications for configuration management:

** Configuration Location
- Config file: =~/.config/blitzer/config.toml=
- Exclusion files: =~/.config/blitzer/[lang_code]_exclusion.txt= (only location looked up)

** Default Configuration
When the config file doesn't exist, it will be created with these defaults:
#+BEGIN_SRC toml
# Blitzer CLI Configuration
# This file uses TOML format

# Default settings
default_language = "pli"  # Default language for config purposes only

# Output settings
include_frequency = false  # Whether to include frequency by default
#+END_SRC

Note: The language flag is now required, so the default_language in the config is only for configuration reference.

** Exclusion Lists
Exclusion lists prevent known words from appearing in output. Language-specific exclusion lists are automatically created in the config directory when first accessing a language.

* Language Support

** Extending Language Support
The architecture uses a plugin system with entry points to make adding new languages much more dynamic and extensible. There are two ways to add support for new languages:

*For Built-in Languages (included with the main package):*
1. Create a new file =blitzer_cli/languages/[lang_code].py=
2. Implement a class extending =BaseLanguageProcessor=
3. Implement the required methods: =tokenize_words()=, =lemmatize()=, and =normalize()=
4. Provide a =get_processor()= factory function that creates and returns an instance of your processor
5. Add an entry point in =pyproject.toml= under =project.entry-points."blitzer.languages"=

*For Plugin Languages (downloadable packages):*
1. Create a separate Python package with name format =blitzer-language-[lang_code]=
2. Include your processor implementation in the package
3. Add an entry point in your package's =setup.py= or =pyproject.toml= under =blitzer.languages=
4. Bundle any required data files (like SQLite databases) with the package
5. Distribute as a pip-installable package

** Language Pack Management
The new =languages= command allows for easy management of downloadable language packs:

#+BEGIN_SRC sh
# List all available languages (built-in and installed plugins)
blitzer languages list

# Install a language pack
blitzer languages install [lang-code]

# Uninstall a language pack
blitzer languages uninstall [lang-code]
#+END_SRC

** Language Dictionaries
The tool supports language-specific dictionaries that enable lemmatization when using the =-L= flag. Lemmatization is the process of grouping together the different inflected forms of a word so they can be analyzed as a single item. For example, in Pali, both "deva" and "devo" would be mapped to the same root form "deva". Language dictionaries are stored in SQLite databases following XDG specifications:

- Database location for built-ins: =~/.config/blitzer/[lang_code]_lexicon.db=
- Database location for plugins: Bundled with the plugin package

The tool looks for these databases but does not create them automatically. When a language dictionary is not available, the tool falls back to basic word processing without lemmatization capabilities.

** Current Language Processors
- =PaliProcessor= :: Handles Pali-specific tokenization, normalization, and lemmatization
- =SlovenianProcessor= :: Handles Slovenian-specific tokenization, normalization, and lemmatization
- =GenericProcessor= :: Basic processor for space-separated languages without lemmatization
- =BaseLanguageProcessor= :: Base class that handles basic tokenization without lemmatization for any other language

* Technical Architecture

** Core Components
- =cli.py= :: Command-line interface using Click
- =config.py= :: XDG configuration management
- =processor.py= :: Core text processing logic
- =languages/= :: Language-specific processing modules

** Processing Pipeline
1. Read text from stdin or from text argument
2. Load appropriate language processor via dynamic import and get_processor function
3. Apply text normalization (if language-specific)
4. Tokenize text into words or lemmatize as needed
5. Apply exclusion filtering
6. Format output according to flags
7. Write results to stdout

** Dependencies
- =click= :: Command-line interface framework
- =tomli= (or =tomllib= for Python 3.11+) :: TOML configuration parsing

* Development

** Adding New Features
The architecture is designed for extensibility:
- Add new language processors in =languages/= directory with get_processor function
- Extend processing capabilities in =processor.py=
- Modify configuration schema in =config.py=

* Changelog

For the complete list of changes, see the =CHANGELOG.org= file.
